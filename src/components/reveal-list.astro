---
type Props = {
  class?: string;
};

const { class: className = "" } = Astro.props;
---

<ul class:list={["space-y-2", className]}>
  <slot />
</ul>

<script is:inline>
  (function () {
    const reduceMotion = window.matchMedia(
      "(prefers-reduced-motion: reduce)",
    ).matches;
    const items = document.querySelectorAll(".reveal");

    if (reduceMotion) {
      items.forEach((el) => el.classList.add("is-visible"));
      return;
    }

    const io = new IntersectionObserver(
      (entries) => {
        for (const entry of entries) {
          if (entry.isIntersecting) {
            entry.target.classList.add("is-visible");
            io.unobserve(entry.target);
          }
        }
      },
      { threshold: 0.15 },
    );

    items.forEach((el) => io.observe(el));
  })();
</script>

<style is:global>
  .reveal {
    opacity: 0;
    transform: translateY(8px);
    transition:
      opacity 400ms ease,
      transform 400ms ease;
    transition-delay: var(--delay, 0ms);
    will-change: opacity, transform;
  }

  .reveal.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  @media (prefers-reduced-motion: reduce) {
    .reveal {
      opacity: 1;
      transform: none;
      transition: none;
    }
  }
</style>
