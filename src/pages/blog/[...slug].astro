---
import Layout from "../../layouts/Layout.astro";
import Hero from "../../components/hero.astro";
import { allPosts, type PostEntry } from "../../lib/posts";

export function getStaticPaths() {
  return allPosts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props as { post: PostEntry };
const publishedTime = post.dateISO.includes("T")
  ? post.dateISO
  : `${post.dateISO}T00:00:00Z`;
const { Content } = post;
---

<Layout
  title={post.title}
  description={post.description}
  ogType="article"
  publishedTime={publishedTime}
>
  <article class="space-y-6">
    <Hero
      title={post.title}
      description={post.description}
      goBack={true}
      backHref="/blog"
    />
    <div class="text-xs text-muted-foreground flex flex-wrap items-center gap-2">
      <span>{post.date}</span>
      {
        post.links?.map((link) => (
          <a
            href={link.url}
            target="_blank"
            rel="noopener noreferrer"
            class="text-[11px] px-2.5 py-1 flex items-center gap-1 rounded-full bg-muted text-muted-foreground hover:text-foreground hover:border-foreground/40 transition-colors"
          >
            <svg
              class="w-3 h-3"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
            </svg>
            {link.label}
          </a>
        ))
      }
    </div>
    <div class="post-content">
      <Content />
    </div>
  </article>
</Layout>
